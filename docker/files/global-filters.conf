#
# To remove our dependency on B&D for rolling out filter updates in the accessibility-assessment image, we're referencing this
# configuration file directly from this repository's master from Jenkins.  Updates to this file that find their way to master
# will be reflected in the Violations reported in Kibana
#
a11y-assessment-config : {
  enable-filters = true

  # Be aware that the descriptionRegex values are taken from the output of the tools, and in the case of VNU contain non-standard double quote characters.
  a11y-filters = [
    {
      tool = "vnu"
      descriptionRegex = """Attribute “readonly” is only allowed when the input type is “date”, “datetime-local”, “email”, “month”, “number”, “password”, “search”, “tel”, “text”, “time”, “url”, or “week”\."""
      snippetRegex = """.*<input.*(type="hidden".*readonly=""|readonly="".*type="hidden"){1}.*>"""
      action {
        govUkIssue = false
        furtherInformation = "While this is a valid finding, readonly attributes on input tags of type 'hidden' have no effect on the page usability or accessibility."
        alertLevel = "WARNING"
      }
    }
    {
      tool = "vnu"
      descriptionRegex = """Attribute “readonly” not allowed on element “input” at this point\."""
      snippetRegex = """.*<input.*(type="hidden".*readonly=""|readonly="".*type="hidden"){1}.*>"""
      action {
        filterGlobally = true
      }
    }
    {
      tool = "vnu"
      descriptionRegex = """Attribute “aria-expanded” not allowed on element “input” at this point\."""
      snippetRegex = """<input.*(type="radio".*aria-expanded|aria-expanded.*type="radio"){1}.*>"""
      action {
        govUkIssue = true
        furtherInformation = "This violation is likely to be triggering off the GovUK radio component when this is implemented with an expanding drop down input field.\nDesign System Ref: https://design-system.service.gov.uk/components/radios/conditional-reveal/index.html \nGovUK Frontend Issue: https://github.com/alphagov/govuk-frontend/issues/979"
      }
    }
    {
      tool = "axe"
      descriptionRegex = """Fix any of the following:  ARIA attribute is not allowed: aria-expanded=\\false\\"""
      snippetRegex = """<input.*(type="radio".*aria-expanded|aria-expanded.*type="radio"){1}.*>"""
      action {
        govUkIssue = true
        furtherInformation = "This violation is likely to be triggering off the GovUK radio component when this is implemented with an expanding drop down input field.\nDesign System Ref: https://design-system.service.gov.uk/components/radios/conditional-reveal/index.html \nGovUK Frontend Issue: https://github.com/alphagov/govuk-frontend/issues/979"
      }
    }
    {
      tool = "axe"
      descriptionRegex = """Incomplete Alert: "Ensures the contrast between foreground and background colors meets WCAG 2 AA contrast ratio thresholds""""
      snippetRegex = """.*"""
      action {
        furtherInformation = "Alerts like this tend to be marked incomplete as axe recognises that there may be some markup rendered on top of an image, and the tool has no way to confirm that the contrast ratio is sufficient."
        alertLevel = "INFO"
      }
    }
    {
      tool = "vnu"
      descriptionRegex = """Attribute “pattern” is only allowed when the input type is “email”, “password”, “search”, “tel”, “text”, or “url”"""
      snippetRegex = """<input.*(type="number"){1}.*>"""
      action {
        govUkIssue = true
        furtherInformation = "Some Govuk components are intentionally implemented this way to cater for limitations when rendered on mobile devices.  One commonly used example at HMRC is the Dates patter.\nDesign system ref: https://design-system.service.gov.uk/patterns/dates/ \n"
      }
    }
    {
      tool = "vnu"
      descriptionRegex = """Element “h[1-6]{1}” not allowed as child of element “legend” in this context\."""
      snippetRegex = """.*"""
      action {
        govUkIssue = true
        furtherInformation = "This is an accepted issue within the GovUK templates. The HTML 5.2 standard will allow heading tags inside legend tags.\nDesign system ref: https://design-system.service.gov.uk/components/fieldset/ \nW3C reference: https://www.w3.org/TR/html52/sec-forms.html#the-legend-element"
        alertLevel = "INFO"
      }
    }
  ]

}
